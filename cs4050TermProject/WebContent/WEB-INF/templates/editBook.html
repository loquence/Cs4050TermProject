<!DOCTYPE HTML>
<html>
<head>
    
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1"> 
    <link href="style.css" type="text/css" rel="stylesheet"/>
    
    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

    <!-- Latest compiled JavaScript -->
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script type="text/javascript">
    	var re = /^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i;
        $(function(){
            var checks= [0,0,0];
            $("button[type=submit]").attr('disabled',"disabled");
            $('signupFrm').submit(function(e){
					e.preventDefault();
					$.ajax({
						type: $(this).attr('method'),
						url: $(this).attr('action'),
						data: $(this).serialize(),
						success:function(responseText){
								$('body').load(responseText);
							}
						})
                });
            
        	
        	$("#allInputs").on('keyup focusin focusout', function(){
					var ch = checks.every(isChecked);
					if (ch){
						$("#signupB").removeAttr('disabled');
						}
					else {
						$("button[type=submit]").attr('disabled',"disabled");
						}
					
            	});
        	function isChecked(element, index, array){
					return element == 1;
            	}
            
            $(".pwds").on('keyup focusin focusout',function(){
            	var pwd = $("#pwd").val();
                var pwd2 =$("#pwd2").val();
				if(pwd.length > 7){
					checks[1]=1;
					if(document.getElementById('validPWD1')){
						}
					else{
						$("#shortPWD").remove();
						$('#pwds1').append("<span id=\"validPWD1\"class=\"input-group-addon checkMarkPwd\"><span class=\"glyphicon glyphicon-ok\"</span></span>");
					}
                	if (pwd !== pwd2){
                    	checks[2]=0;
                    	if (document.getElementById('invalidPWD')){
                    	}else {
                    		$('#checkMarkPwd').remove();
                    		$('#pwds2').append("<span id=\"xMarkPwd\"class=\"input-group-addon xMarkPwd\"><span class=\"glyphicon glyphicon-remove\"</span></span>");
							$("#toGo").append("<p id=\"invalidPWD\" style=\"color:red\">These passwords are not the same</p>");
							
                    	}
                	}
                	else {
                    	checks[2]=1;
                    	if (document.getElementById('checkMarkPwd')){
                        }else {
							$('#invalidPWD').remove();
							$('#xMarkPwd').remove();
							$('#pwds2').append("<span id=\"checkMarkPwd\"class=\"input-group-addon checkMarkPwd\"><span class=\"glyphicon glyphicon-ok\"</span></span>")
							
                        }
                    }
				}
				else {
					checks[1]=0;
					if (document.getElementById('shortPWD')){
						}
					else {
						$("#validPWD1").remove();
						$('#toGoPwd').append("<p id=\"shortPWD\" style=\"color:red\">Passwords must be 8 characters or greater.</p>")
						
						
					}
					}    
            });
            $("#emailDiv").on('focusin focusout keyup',function(){
                var em = $("#email").val();
            	var val = {name:"email", email:em}
            	if (!em.match(re)){
                	if (document.getElementById('invalidEmail')){
                    	}
                	else {
                    	checks[0]=0;
                    	$('#checkMark').remove();
                    	if(!document.getElementById('xMark')){
        					$('#emailDiv').append("<span id=\"xMark\" class=\"input-group-addon\"><span class=\"glyphicon glyphicon-remove\"</span></span>");
                    	}
    					$('#toGoEmail').append("<p id=\"invalidEmail\" style=\"color:red\">This email is not valid.</p>");
                	}
               	}
            	else {
                	$('#invalidEmail').remove();
               	 	$.ajax({
                    	url:"BookstoreServlet",
                    	data: val,
                    	datatype:"json",
                    	method:"GET",
                    	success: function(json){
                     		
                       		if (!json.email){
                           		checks[0]=1;
                           		if(!document.getElementById('checkMark')){
                               		$('#xMark').remove();
                               		$('#emailDiv').append("<span id =\"checkMark\" class=\"input-group-addon\"><span class=\"glyphicon glyphicon-ok\"</span></span>");
                               		$("#takenEmail").remove();
                       				}
                        	}else {
                            	if(!document.getElementById('takenEmail')) {
                                	checks[0]=0;
                            		$('#toGoEmail').append("<p id=\"takenEmail\" style=\"color:red\">This email is not taken.</p>");
                                	$('#checkMark').remove();
                                	if(!document.getElementById('xMark')){
                        				$('#emailDiv').append("<span id=\"xMark\" class=\"input-group-addon\"><span class=\"glyphicon glyphicon-remove\"</span></span>");
                                	}
                               	}
                    	    }
                         },
                    	error: function(data) {
								console.log('An error occured.');
								console.log(data);
                        	}
                    
                	})
            	}
            });
            
    	});
    </script>
       
    <title>Edit Books</title>
    <link rel="shortcut icon" type="image/png" href="http://weknowyourdreams.com/images/book/book-08.jpg"/>    
    </head>
    
    <body>
    
        <table style ="width: 100%">
            <tr>
                <th>ISBN</th>
                <th>TITLE</th>
                <th>CATEGORY</th>
                <th>AUTHOR</th>
                <th>EDITION</th>
                <th>PUBLISHER</th>
                <th>PUB YEAR</th>
                <th>MIN THRESH</th>
                <th>BUYING PRICE</th>
                <th>SELLING PRICE</th>
                <th>COVER</th>
                <th>RATING</th>
            </tr>
            <tr>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
                <td>sample</td>
            </tr>
        
        </table>
    
    </body>
    
</html>